<?php
require 'vendor/autoload.php';
use \Firebase\JWT\JWT;

$privateKey = <<<EOD
-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQC8kGa1pSjbSYZVebtTRBLxBz5H4i2p/llLCrEeQhta5kaQu/Rn
vuER4W8oDH3+3iuIYW4VQAzyqFpwuzjkDI+17t5t0tyazyZ8JXw+KgXTxldMPEL9
5+qVhgXvwtihXC1c5oGbRlEDvDF6Sa53rcFVsYJ4ehde/zUxo6UvS7UrBQIDAQAB
AoGAb/MXV46XxCFRxNuB8LyAtmLDgi/xRnTAlMHjSACddwkyKem8//8eZtw9fzxz
bWZ/1/doQOuHBGYZU8aDzzj59FZ78dyzNFoF91hbvZKkg+6wGyd/LrGVEB+Xre0J
Nil0GReM2AHDNZUYRv+HYJPIOrB0CRczLQsgFJ8K6aAD6F0CQQDzbpjYdx10qgK1
cP59UHiHjPZYC0loEsk7s+hUmT3QHerAQJMZWC11Qrn2N+ybwwNblDKv+s5qgMQ5
5tNoQ9IfAkEAxkyffU6ythpg/H0Ixe1I2rd0GbF05biIzO/i77Det3n4YsJVlDck
ZkcvY3SK2iRIL4c9yY6hlIhs+K9wXTtGWwJBAO9Dskl48mO7woPR9uD22jDpNSwe
k90OMepTjzSvlhjbfuPN1IdhqvSJTDychRwn1kIJ7LQZgQ8fVz9OCFZ/6qMCQGOb
qaGwHmUK6xzpUbbacnYrIM6nLSkXgOAwv7XXCojvY614ILTK3iXiLBOxPu5Eu13k
eUz9sHyD6vkgZzjtxXECQAkp4Xerf5TGfQXGXhxIX52yH+N2LtujCdkQZjXAsGdm
B2zNzvrlgRmgBrklMTrMYgm1NPcW+bRLGcwgW2PTvNM=
-----END RSA PRIVATE KEY-----
EOD;

$publicKey = <<<EOD
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC8kGa1pSjbSYZVebtTRBLxBz5H
4i2p/llLCrEeQhta5kaQu/RnvuER4W8oDH3+3iuIYW4VQAzyqFpwuzjkDI+17t5t
0tyazyZ8JXw+KgXTxldMPEL95+qVhgXvwtihXC1c5oGbRlEDvDF6Sa53rcFVsYJ4
ehde/zUxo6UvS7UrBQIDAQAB
-----END PUBLIC KEY-----
EOD;

$token = array(
    "iss" => "example.org",
    "aud" => "example.com",
    "iat" => 1356999524,
    "nbf" => 1357000000
);

$jwt = JWT::encode($token, $privateKey, 'RS256');
echo "Encode:\n" . print_r($jwt, true) . "\n";

$decoded = JWT::decode($jwt, $publicKey, array('RS256'));

/*
 NOTE: This will now be an object instead of an associative array. To get
 an associative array, you will need to cast it as such:
*/

echo nl2br("\n\n");

$decoded_array = (array) $decoded;
echo "Decode:\n" . print_r($decoded_array, true) . "\n";


echo nl2br("\n\n");

$key_a = <<<EOD
-----BEGIN CERTIFICATE-----
MIIDHDCCAgSgAwIBAgIISNhlRy+TgBowDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE
AxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcx
MDAzMDA0NTI2WhcNMTcxMDA2MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl
bi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBANCdUaIOnRzNHvjxdVdfvWhPV1tjgFsQGGr51ZyVomJkseUF
cCO8mE6QfTHtdjohv3T2heTG+Ad4rqIjkjuMxnZLSM4uFRsTFbbHxrd1Ct+itw5J
i5KKo+hciK+1Z2IIm0a/9wTIoyRoL4EmC1+0Q6aoLKM3mWQ9sI1pPs1MC/5x51fP
aF5/VnWyebQF0/b29X2gc+uS4JkWc81wzp+rFj7Ya4BRbl8UVnBNeb+3kFqwOiRa
X5/2jU1d1RwqRsQS1Z/AlK28dJhR4jz9yfVnndtMuUaPa/LU5+M+rBMYP6O4Gclh
wt8QTAo4BNCsYhQaYOpmhgv88+SNH1eJe2+s3ncCAwEAAaM4MDYwDAYDVR0TAQH/
BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ
KoZIhvcNAQEFBQADggEBAMMZpNHCih7xPbe5F1k3rk2Jx4nPZcO1V4h8I1hcu9DX
AYqMCRVyErGCOeffYVCeWZf9XzksTMsJDkOqXTZhYNFts/IkNvZXlUY1G5ho79o9
hvTST6GrGJkvcK98p0Ybr2ic0GLElOtIifF//mWHeZuBTBjoJIYL++HHrwT73Qb5
ctagEGj1C7aCCBv/GkCdGqVZV//rUe6j1ay/twSEvOxWoseMLlLDM30MbYk5X3IL
jN0RxjFzqsyfeYDqoM7deEo0tAD70LxjhSXncXwcUlVuZ0IzwkC9rlXussZUkq46
PoJcsT+lHRinmr14oZ/zS9Hc0AGT8jDKHiLP/rZr0Kc=
-----END CERTIFICATE-----
EOD;

$key_b = <<<EOD
-----BEGIN CERTIFICATE-----
MIIDHDCCAgSgAwIBAgIIMkw4pR7qYzkwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE
AxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcx
MDAxMDA0NTI2WhcNMTcxMDA0MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl
bi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAIStQMZTv9ParhqrLrXcJXMavtfdH2KbMqgOkk/AR4vk3eZ5
8R7ixNwQvPn+qmVqME0/Cb+vlZxp48zDmxM2nRqrsaHeF8XDfyr9D592QhkHu61t
AQKvNilHVGhkFX3ju7Lv6LLyRW9EM+ErJladTCpdVp+8S/4leG68WCjJZ6N8AuTZ
5/BUdY6IrEACYNV8u6zPQmJjPIEAfvbqLZnRV+iWPA+XgAXsBi1OP7NLd3DfS629
n7uC2J2Hn9f0ZLrBdmrzXu3qqnUIA6ErHVAmMQAeKA66MMbEOLRKMl9CmYp7wQE5
7ZkbH7qolIW7cVFwg6AV9598JwUQhXiiNMacIfUCAwEAAaM4MDYwDAYDVR0TAQH/
BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ
KoZIhvcNAQEFBQADggEBAH3D8wTN1sQ4yzNgAQGA57wtQQL5++uwocSSayU05w/O
3DQd2qwZAz0Ss0zJU412nPTFamkH6jkq1SxaKX/S+P64cnZR+kVWpHarlmvrfVlv
/PC+qZ75Ysty5sIEN4BCBNA8coOBge3tl/0uis7788k9yBVSF0ojABOWDcrrdMBS
sm5FSaGv+dEcGd+VcptSrBjqML2ClqvV0r7stHTjXvOZ7pShx/zTaaeP3jzbQaGM
RjRiT2nSo+I5c8nWPnBYnR4Lg5qhZCq7IoChVDHl1e3+q/jNE9EXAD1dBFfAal0W
g6xxkXMBkNng1AyXv8TJEBeWzwjKK8baTznPBAazRJk=
-----END CERTIFICATE-----
EOD;
$key_c = <<<EOD
-----BEGIN CERTIFICATE-----
MIIDHDCCAgSgAwIBAgIIWtHj2kBw3oswDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE
AxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcx
MDAyMDA0NTI2WhcNMTcxMDA1MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl
bi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBALdnyQzVV141qxJHvdtBD5PrWgQ6r7D3RVaUiqO8LL5Qthk5
9kohyfLlUBgv/Qb6Ki8n7BGH3AV3/BEh9BdY+9ibvrFcsoGYmmUEVL0DsGhOg9yN
2TClzHL3y0KzxQIFN1b4aTmpuH0ayKYs20cdBqwc7P+Djo7pUQw8Z2VLUsTa/PzD
RuwSDD4QzNfWPUtoMfRmobwIhNntBMXs6UjBhxYp988yp5pj/Uf3ed8fhv6qRy/v
g4EQHKY03SvynJVV7fTE4H0+BM+gsD5eb2sIvXTTNOdmLGjyv9i+6H6X1ZoiD9Ey
Yf9bdm+/xURKtOxiIDJC1jj95Ojt2Zh8I7gNYtUCAwEAAaM4MDYwDAYDVR0TAQH/
BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ
KoZIhvcNAQEFBQADggEBAJPrKzQ3CTRYZfhG35FNqGy92+eChDTZRl9kDu9DIBnZ
lqliaHISh7SCWnsmWIfpu5EBVL2Hq+yzRd9rIa+qUEoYkdCNdxa9QCzMhJaeCGa8
yKaNFGjREY30WzhvDXuOsjO0dxicvFycDJZRCtFSlxT7OJ11NwLlsva787zwHzGE
3ezJlAzlCJ2LkT8H8N4tJfnizjk3fjLatLaG2l4T4YkZEAfLjPg38GiFgUwGmNbS
bWzqZzWU/nJ95kgrr624w84jLdhN+E6LDSZNOo+i9tQIAXyDF/CCncyqMgK5cPqp
EDTqHb4a0jBW0nDSjjwp1zF4gX22yHVnfGfC0gp9qOk=
-----END CERTIFICATE-----
EOD;
$key_d = <<<EOD
-----BEGIN CERTIFICATE-----
MIIDHDCCAgSgAwIBAgIIb2RRsOZ0X5IwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE
AxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcx
MDA0MDA0NTI2WhcNMTcxMDA3MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl
bi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAN+7VANsxgWftZ35Q1PGCw+j7mh964Kxiw96hZSJXpyRarwV
2AROYuv/pwMBDJIeER/eRgzIEzfUP5bXIKmwXiJbCB3SYBEOe1RypiSLLFHinAQ6
ML+idl5CBM0hJe2FqUTlwlf0WqbMUmnU0VPxrMkp8W/5syvsYCDpvZ1+Xb0cU3cV
J9Krxzx7O39SdAna0PJjRuodpNTr159H0bXgUBRXPdqMzE3S3Py+0pTU9qDbKjNc
LjGTH45O2+puzPMvXFWv82BCrPSzRWxXJa9Yjhihl93Rz2Ax4bpdAeArzh0FvDH0
rVc24m3ttoPnzf3Ocmg7dkYsFmA/9HWoZgd20sMCAwEAAaM4MDYwDAYDVR0TAQH/
BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ
KoZIhvcNAQEFBQADggEBAMIQi1ciCvLuIZBYEq1GK5jxWgTwWRrwhzXHD3OAA++I
uFFSJFXcYY7OBa23WQaxgRNSo8Jhdi/kmcpulQdNX6KTPhK5f3ax4fZXcZUJLRNi
0VzMGLNWtV4DgLFR22LprFkCiOYytTulIIAMtnFM2pPACVy6HDqhF0BWj22MSjHf
mFjFN+NiFDPaXNl/gSr8Hl7QsHAcd2EXyIXUqfqz7QR8yN6Rjrg2YLVVE/2108B6
MmWrSLDaY8rXe2wlHcMdIDtI99Cb6qvB8Sz6B8M65pAHQZgx2hYpXaZAXnjYve7M
qOCUfGfrxPwoY9mbZlXY0kvAYkOyPwwO/SMiYlpys/w=
-----END CERTIFICATE-----
EOD;

$publicKey2 = <<<EOD
"-----BEGIN CERTIFICATE-----
MIIDHDCCAgSgAwIBAgIISNhlRy+TgBowDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE
AxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcx
MDAzMDA0NTI2WhcNMTcxMDA2MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl
bi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBANCdUaIOnRzNHvjxdVdfvWhPV1tjgFsQGGr51ZyVomJkseUF
cCO8mE6QfTHtdjohv3T2heTG+Ad4rqIjkjuMxnZLSM4uFRsTFbbHxrd1Ct+itw5J
i5KKo+hciK+1Z2IIm0a/9wTIoyRoL4EmC1+0Q6aoLKM3mWQ9sI1pPs1MC/5x51fP
aF5/VnWyebQF0/b29X2gc+uS4JkWc81wzp+rFj7Ya4BRbl8UVnBNeb+3kFqwOiRa
X5/2jU1d1RwqRsQS1Z/AlK28dJhR4jz9yfVnndtMuUaPa/LU5+M+rBMYP6O4Gclh
wt8QTAo4BNCsYhQaYOpmhgv88+SNH1eJe2+s3ncCAwEAAaM4MDYwDAYDVR0TAQH/
BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ
KoZIhvcNAQEFBQADggEBAMMZpNHCih7xPbe5F1k3rk2Jx4nPZcO1V4h8I1hcu9DX
AYqMCRVyErGCOeffYVCeWZf9XzksTMsJDkOqXTZhYNFts/IkNvZXlUY1G5ho79o9
hvTST6GrGJkvcK98p0Ybr2ic0GLElOtIifF//mWHeZuBTBjoJIYL++HHrwT73Qb5
ctagEGj1C7aCCBv/GkCdGqVZV//rUe6j1ay/twSEvOxWoseMLlLDM30MbYk5X3IL
jN0RxjFzqsyfeYDqoM7deEo0tAD70LxjhSXncXwcUlVuZ0IzwkC9rlXussZUkq46
PoJcsT+lHRinmr14oZ/zS9Hc0AGT8jDKHiLP/rZr0Kc=
-----END CERTIFICATE-----
EOD;

$keys = array(
    "ebeb937baeb5c6bd9f3ff96d5f2481146c8d58b1" => $key_a,
    "11c8cfa1e4b8ac9813accc806e1326959ee46fa3" => $key_b,
    "1cc8de3c565d235d92e6f56fbc471c46d58e558b" => $key_c,
    "1ef6304b8db2f5628240a08c4b5d1bd36573b920" => $key_d,
);

$jwt2 = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImViZWI5MzdiYWViNWM2YmQ5ZjNmZjk2ZDVmMjQ4MTE0NmM4ZDU4YjEifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vZ20tY2x1c3RlcmVyIiwibmFtZSI6Iktpbm9zaGl0YSBSZW50YXJvIiwicGljdHVyZSI6Imh0dHBzOi8vc2NvbnRlbnQueHguZmJjZG4ubmV0L3YvdDEuMC0xL3AxMDB4MTAwLzEwNDkyMDUyXzY4Njk4MTE2MTM4MDU3OF82NTI5ODQxNjkzMjgxMTE1Mjc0X24uanBnP29oPWY0MjIxMzAzYzNkODQwNDcxNGEzYmU2OWIxYjVmNDA2Jm9lPTVBNDEyQkM4IiwiYXVkIjoiZ20tY2x1c3RlcmVyIiwiYXV0aF90aW1lIjoxNTA3MDY5MzE5LCJ1c2VyX2lkIjoib0Z4dTlwbDZYRlpPdjNESklVWHdFU1V0S2IyMiIsInN1YiI6Im9GeHU5cGw2WEZaT3YzREpJVVh3RVNVdEtiMjIiLCJpYXQiOjE1MDcwNzA1NzAsImV4cCI6MTUwNzA3NDE3MCwiZW1haWwiOiJyazdmZDNzQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7ImZhY2Vib29rLmNvbSI6WyIxNTI0NzEwNjA0Mjc0MjkyIl0sImVtYWlsIjpbInJrN2ZkM3NAZ21haWwuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoiZmFjZWJvb2suY29tIn19.CC0EHSjIc7WZe2dkHNKGSNi7rFJYCfDvuP3iZ2-UJgiKT99o7cnvK3lauf2M84-8YSMYa3wkP9BdCfD58cZO4FFXX1VCAGX2nl_YTjA_4xqCKQVBjGIxMh5tbWTQrXuI5Sa6371D6jKDzY2xDdCwC7A003R-G-IBnceLAgocPPANf7kcSFdz9QrGy_W2nUDfONSextfNpQtR2I2UTDFIZk4srRqQ77PUV8hn49GctrrJO_oHIM78FSl4KBNuQ6_rkHsGaFY0kU9Z8WwrhP6Xt-g_Yu9StUfbnfdsWvtrZxWbs-r3oKr3b0T5ZWZoKMzKzEzhdLPVcGp_pZgZywOAuA";

$decoded2 = JWT::decode($jwt2, $keys, array('RS256'));

$decoded_array2 = (array) $decoded2;
echo "Decode2:\n" . print_r($decoded_array2, true) . "\n";

?>
